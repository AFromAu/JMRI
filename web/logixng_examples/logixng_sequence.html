<html>
<head>
<title>LogixNG sequence</title>

<meta charset="utf-8"/>

        <!-- include the jquery.jmri library and its dependencies -->
        <script src="/js/jquery-1.11.2.min.js"></script>
        <script src="/js/json2.js"></script>
        <script src="/js/jquery.websocket.js"></script>
        <script src="/js/logger.js"></script>
        <script src="/js/jquery.jmri.js"></script>
        <script src="logixng_sequence.js"></script>
        <script type="text/javascript">
            // set the jmri global variable to null
            var jmri = null;
            $(document).ready(function() {
                // once the document is loaded, assign a $.JMRI object to
                // the jmri variable and overload two functions:
                // open() and power(state)
                jmri = $.JMRI({
                    // call getPower() when the JMRI WebSocket connection opens
                    // getPower() does two things: it requests the current power
                    // status from JMRI and it starts the power status monitor
                    // on the JMRI server.
                    open: function() {
                        jmri.getPower();
						jmri.getMemory("IM_91");
                    },


                    memory: function(name, value, data) {
						console.log("Memory name: "+name);
						console.log("Memory value: "+value);
						console.log("Memory data: "+data);
//						jmri.setMemory("IM_92", "Hej");
					},


                    throttle: function(data) {
						console.log("Throttle data: "+data);
					},







                    // when the JMRI object receives a power update, call this
                    // function, regardless of source of update
                    power: function(state) {
                        power = state;
						console.log("Power: "+power);
/*
                        switch (power) {
                            case jmri.UNKNOWN:
                                $('#powerImg').prop('src', "/images/PowerGrey.png");
                                $('#powerImg').prop('alt', "Unknown");
                                $('#powerImg').prop('title', "Unknown");
                                break;
                            case jmri.POWER_ON:
                                $('#powerImg').prop('src', "/images/PowerGreen.png");
                                $('#powerImg').prop('alt', "Powered On");
                                $('#powerImg').prop('title', "Powered On");
                                break;
                            case jmri.POWER_OFF:
                                $('#powerImg').prop('src', "/images/PowerRed.png");
                                $('#powerImg').prop('alt', "Powered Off");
                                $('#powerImg').prop('title', "Powered Off");
                                break;
                        }
*/
                    }
                });
                // trigger the initial connection to the JMRI server; this
                // method call ensures the jmri.open() method is called after
                // a timeout to begin using fall back methods for monitoring
                // items on the JMRI server even if a WebSocket connection
                // cannot be established
                jmri.connect();
                // make it possible to click on the power button to turn track
                // power on or off without using a javascript URI
                $('#powerImg').click(function(event) {
                    jmri.setPower((power === jmri.POWER_ON) ? jmri.POWER_OFF : jmri.POWER_ON);
                });
            });
        </script>




</head>
<body>
<h1>LogixNG - Sequence</h1>




<svg id="svg-object" width="800" height="800">
  <circle id="Daniel1" cx="50" cy="50" r="40" stroke="green" stroke-width="4" fill="yellow" />
  <rect id="Daniel2" x="100" y="100" width="200" height="200" stroke="green" stroke-width="4" fill="yellow" />
  <defs>
    <g id="DanielAA">
      <circle id="Daniel1" cx="0" cy="0" r="40" stroke="green" stroke-width="4" fill="yellow" />
      <rect id="Daniel" x="0" y="0" width="200" height="200" stroke="green" stroke-width="4" fill="yellow" />
	</g>
  </defs>

  <use id="DanielBB" x="0" y="0" xlink:href="#DanielAA">
</svg>

<script>
//window.setInterval(myTimer, 1000);

var circle = document.getElementById('Daniel1');

console.log("circle: "+circle);
/*
for (var key in circle) {
  console.log(key);
}
*/



var angle = 0;

function myTimer() {
//  var circle = document.getElementById('Daniel1');
//  var cx = parseFloat(circle.getAttributeNS(null, 'cx'));
//  circle.setAttributeNS(null, 'cx', cx + 10);

//  var circle = document.getElementById('DanielAA');
  var circle = document.getElementById('DanielBB');
  var x = parseFloat(circle.getAttributeNS(null, 'x'));
//  circle.setAttributeNS(null, 'x', x + 1);
//  circle.setAttributeNS(null, 'rotate', '20deg');
//  circle.setAttributeNS(null, 'x', 0);
//  circle.setAttribute("transform", "translate(-100,-100) rotate("+angle+") translate(100,100)");
  circle.setAttribute("transform", "rotate("+angle+") translate(100,100)");
//  circle.setAttributeNS(null, 'x', 100);
  angle += 10;
} 

</script>

</body>
</html>
